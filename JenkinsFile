pipeline {
   agent any 
   stages{
     stage('Git checkout') {
     steps{
            git branch: 'main', credentialsId: 'github-cred', url: 'https://github.com/demodevops2/devopscls25repo.git'
            }
     
     }

     stage('Build stage'){
       steps {
          sh '  mvn clean package ' 
       }
     
     }

     stage('Deploy to Tomcat'){

       sshagent(['tomcat-ec2-id']) {
          sh 'sudo scp -o StrictHostKeyChecking=no target/*.war 172.31.43.104:/var/lib/tomcat8/webapps/'
       }
    }



   
   }
  }
